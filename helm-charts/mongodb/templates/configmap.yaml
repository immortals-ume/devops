apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "mongodb.fullname" . }}
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "mongodb.labels" . | nindent 4 }}
data:
  mongod.conf: |
    # MongoDB configuration file
    storage:
      dbPath: /data/db
      journal:
        enabled: true
    
    systemLog:
      destination: file
      logAppend: true
      path: /var/log/mongodb/mongod.log
      verbosity: {{ .Values.configMap.logVerbosity }}
    
    net:
      port: 27017
      bindIp: 0.0.0.0
    
    {{- if .Values.replicaSet.enabled }}
    replication:
      replSetName: {{ .Values.replicaSet.name }}
    {{- end }}
    
    {{- if .Values.auth.enabled }}
    security:
      authorization: enabled
    {{- end }}
